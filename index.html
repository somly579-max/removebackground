<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pro Background Remover</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.14/dist/tailwind.min.css" rel="stylesheet">
<style>
body { background: #0f172a; color: #e2e8f0; font-family: system-ui, sans-serif; }
canvas, img { max-width:100%; border-radius:12px; }
button:disabled { opacity:.5; cursor:not-allowed; }
</style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
<div class="bg-slate-800/60 backdrop-blur-md rounded-2xl shadow-2xl p-6 max-w-3xl w-full">
  <h1 class="text-2xl font-bold text-center mb-2">AI Background Remover (Pro)</h1>
  <p class="text-center text-slate-400 mb-4">High-quality cutout powered by remove.bg or Pixian.ai</p>

  <div class="flex flex-col md:flex-row gap-6">
    <div class="flex-1">
      <h3 class="font-semibold mb-2 text-center">Original</h3>
      <canvas id="original" class="bg-white"></canvas>
    </div>
    <div class="flex-1">
      <h3 class="font-semibold mb-2 text-center">Result</h3>
      <img id="result" alt="Result Preview" class="hidden bg-white" />
      <canvas id="preview" class="bg-white"></canvas>
    </div>
  </div>

  <div class="text-center mt-6">
    <input type="file" id="fileInput" accept="image/*" class="hidden">
    <label for="fileInput" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg cursor-pointer font-semibold">Choose Image</label>
    <button id="removeBtn" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-semibold ml-2" disabled>Remove Background</button>
  </div>

  <div class="text-center mt-4">
    <button id="downloadPng" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg font-semibold" disabled>Download PNG</button>
    <button id="downloadJpg" class="bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg font-semibold ml-2" disabled>Download JPG</button>
  </div>

  <p id="status" class="text-center text-slate-400 mt-4">Waiting for image...</p>
</div>

<script>
const fileInput = document.getElementById('fileInput');
const removeBtn = document.getElementById('removeBtn');
const downloadPng = document.getElementById('downloadPng');
const downloadJpg = document.getElementById('downloadJpg');
const statusEl = document.getElementById('status');
const originalCanvas = document.getElementById('original');
const previewCanvas = document.getElementById('preview');
const resultImg = document.getElementById('result');
const oCtx = originalCanvas.getContext('2d');
const pCtx = previewCanvas.getContext('2d');
let currentImageBlob = null;

fileInput.addEventListener('change', e => {
  const file = e.target.files[0];
  if (!file) return;
  const img = new Image();
  img.onload = () => {
    const scale = Math.min(800 / img.width, 600 / img.height, 1);
    const w = img.width * scale, h = img.height * scale;
    originalCanvas.width = w; originalCanvas.height = h;
    previewCanvas.width = w; previewCanvas.height = h;
    oCtx.drawImage(img, 0, 0, w, h);
    pCtx.clearRect(0,0,w,h);
    removeBtn.disabled = false;
    statusEl.textContent = "Image loaded. Ready to remove background.";
  };
  img.src = URL.createObjectURL(file);
  currentImageBlob = file;
});

// Professional background removal using remove.bg API
removeBtn.addEventListener('click', async () => {
  if (!currentImageBlob) return;
  removeBtn.disabled = true;
  statusEl.textContent = "Processing high-quality background removal...";
  try {
    const formData = new FormData();
    formData.append("image_file", currentImageBlob);
    formData.append("size", "auto");

    // ðŸ”¹ Replace with your own API key from remove.bg or Pixian.ai
    const API_KEY = "YOUR_API_KEY_HERE";
    const res = await fetch("https://api.remove.bg/v1.0/removebg", {
      method: "POST",
      headers: { "X-Api-Key": API_KEY },
      body: formData
    });

    if (!res.ok) throw new Error("API error: " + res.status);
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    resultImg.src = url;
    resultImg.classList.remove('hidden');
    previewCanvas.classList.add('hidden');
    statusEl.textContent = "Done! Download your clean image.";
    downloadPng.disabled = false;
    downloadJpg.disabled = false;

    // cache blob for downloads
    resultImg.dataset.blobUrl = url;
  } catch (err) {
    console.error(err);
    statusEl.textContent = "Failed to remove background. (Check your API key)";
  } finally {
    removeBtn.disabled = false;
  }
});

// Downloads
downloadPng.addEventListener('click', () => {
  const a = document.createElement('a');
  a.href = resultImg.dataset.blobUrl;
  a.download = "removed-bg.png";
  a.click();
});

downloadJpg.addEventListener('click', async () => {
  const img = new Image();
  img.src = resultImg.dataset.blobUrl;
  await img.decode();
  const c = document.createElement('canvas');
  c.width = img.width;
  c.height = img.height;
  const ctx = c.getContext('2d');
  ctx.fillStyle = "#fff";
  ctx.fillRect(0,0,c.width,c.height);
  ctx.drawImage(img,0,0);
  const a = document.createElement('a');
  a.href = c.toDataURL('image/jpeg', 0.9);
  a.download = "removed-bg.jpg";
  a.click();
});
</script>
</body>
</html>
